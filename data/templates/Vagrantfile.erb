Vagrant.configure(2) do |config|
  config.vm.box = "centos7"
  config.vm.box_url = "https://f0fff3908f081cb6461b407be80daf97f07ac418.googledrive.com/host/0BwtuV7VyVTSkUG1PM3pCeDJ4dVE/centos7.box"
  <%="config.vm.network 'forwarded_port', guest: 2376, host: #{port}"%>

  config.vm.provider "virtualbox" do |v|
    <%="v.name = '#{name}'"%>
  end

  <% if tls %>
  <% %w(ca.pem server.pem server-key.pem).each do |file|%>
  <%="config.vm.provision 'file', source: '/tmp/docker_init/#{file}', destination:'/tmp/docker_init/#{file}'"%>
  <%end%>
  config.vm.provision :shell, privileged: true, :inline => "mkdir -p /etc/pki/tls/docker/"
  config.vm.provision :shell, privileged: true, :inline => "cp /tmp/docker_init/*.pem /etc/pki/tls/docker/"
  <%end%>

  config.vm.provision "shell", path: "/tmp/docker_init/provision.sh"
end
